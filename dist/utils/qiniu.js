"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var uploadImageFn=function(){var u=_asyncToGenerator(regeneratorRuntime.mark(function e(r,p,l,f,d){var t,n,a,u,o,i,s,c,m,h=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=function(c){var n,e=new Promise((n=_asyncToGenerator(regeneratorRuntime.mark(function e(n,r){var t,a,u,o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.file){e.next=4;break}n(c),e.next=13;break;case 4:return t=c.url.slice(c.url.lastIndexOf("/")+1),e.next=7,_req2.default.get(p,{filesystem:l,filetype:f,filename:t});case 7:a=e.sent,u=a.token,o=a.key,i=a.domain,s=uploadURLFromRegionCode(d),_index2.default.uploadFile({url:s,filePath:c.url,name:"file",formData:{token:u,key:o},success:function(e){var r=JSON.parse(e.data);console.log(r),n({url:i+"/"+r.key})},fail:function(e){return r(e)}});case 13:case"end":return e.stop()}},e,h)})),function(e,r){return n.apply(this,arguments)}));t.push(e)},u=!(a=!0),o=void 0,e.prev=5,i=r[Symbol.iterator]();!(a=(s=i.next()).done);a=!0)c=s.value,n(c);e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),u=!0,o=e.t0;case 13:e.prev=13,e.prev=14,!a&&i.return&&i.return();case 16:if(e.prev=16,u)throw o;e.next=19;break;case 19:return e.finish(16);case 20:return e.finish(13);case 21:return e.next=23,Promise.all(t);case 23:return m=e.sent,e.abrupt("return",m);case 25:case"end":return e.stop()}},e,this,[[5,9,13,21],[14,,16,20]])}));return function(e,r,n,t,a){return u.apply(this,arguments)}}(),_index=require("../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_req=require("../api/req.js"),_req2=_interopRequireDefault(_req);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var i=e.apply(this,arguments);return new Promise(function(u,o){return function r(e,n){try{var t=i[e](n),a=t.value}catch(e){return void o(e)}if(!t.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});u(a)}("next")})}}function resolveBlobFromFile(e,r){return fetch(e).then(function(e){return e.blob()}).then(function(e){return e.slice(0,e.size,r)})}function uploadURLFromRegionCode(e){var r=null;switch(e){case"z0":r="https://up.qiniup.com";break;case"z1":r="https://up-z1.qiniup.com";break;case"z2":r="https://up-z2.qiniup.com";break;case"na0":r="https://up-na0.qiniup.com";break;case"as0":r="https://up-as0.qiniup.com";break;default:console.error("please make the region is with one of [z0, z1, z2, na0, as0]")}return r}exports.default={uploadImageFn:uploadImageFn};