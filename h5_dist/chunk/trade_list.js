(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{"351":function(e,t,n){"use strict";n(4);var r=n(17),a=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0};function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,a){try{var o=t[r](a),i=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}var i={"WILL_MOUNT":0,"DID_MOUNT":1,"DID_SHOW":2};function withLogin(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.WILL_MOUNT;return void 0!==i[t]?(console.warn("lifeCycle is not in defined types: "+t),function(e){return e}):function withLoginComponent(e){return function(n){function WithLogin(e){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WithLogin),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(WithLogin.__proto__||Object.getPrototypeOf(WithLogin)).call(this,e))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(WithLogin,e),a(WithLogin,[{"key":"componentWillMount","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var e;return regeneratorRuntime.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(t!==i.WILL_MOUNT){n.next=9;break}return n.next=3,this.$__autoLogin();case 3:if(n.sent){n.next=6;break}return n.abrupt("return");case 6:o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this)&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this).call(this),n.next=13;break;case 9:return n.next=11,this.$__autoLoginDone();case 11:e=n.sent,o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this)&&e&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this).call(this);case 13:case"end":return n.stop()}},_callee,this)}));return function componentWillMount(){return e.apply(this,arguments)}}()},{"key":"componentDidMount","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var e;return regeneratorRuntime.wrap(function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:if(t!==i.DID_MOUNT){n.next=9;break}return n.next=3,this.$__autoLogin();case 3:if(n.sent){n.next=6;break}return n.abrupt("return");case 6:o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this)&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this).call(this),n.next=13;break;case 9:return n.next=11,this.$__autoLoginDone();case 11:e=n.sent,o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this)&&e&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this).call(this);case 13:case"end":return n.stop()}},_callee2,this)}));return function componentDidMount(){return e.apply(this,arguments)}}()},{"key":"componentDidShow","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var e;return regeneratorRuntime.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:if(t!==i.DID_SHOW){n.next=9;break}return n.next=3,this.$__autoLogin();case 3:if(n.sent){n.next=6;break}return n.abrupt("return");case 6:o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this)&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this).call(this),n.next=13;break;case 9:return n.next=11,this.$__autoLoginDone();case 11:e=n.sent,o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this)&&e&&o(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this).call(this);case 13:case"end":return n.stop()}},_callee3,this)}));return function componentDidShow(){return e.apply(this,arguments)}}()},{"key":"$__autoLogin","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var e;return regeneratorRuntime.wrap(function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return this.$__autoLogin_state="pending",e=void 0,t.prev=2,t.next=5,r.a.autoLogin(this);case 5:e=t.sent,this.$__autoLogin_state=e?"success":"fail",t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),this.$__autoLogin_state="fail";case 12:return t.abrupt("return",e);case 13:case"end":return t.stop()}},_callee4,this,[[2,9]])}));return function $__autoLogin(){return e.apply(this,arguments)}}()},{"key":"$__autoLoginDone","value":function $__autoLoginDone(){var e=void 0,t=8,n=this;return new Promise(function(r){!function next(){e&&clearTimeout(e),e=setTimeout(function(){var a=n.$__autoLogin_state;"success"===a||"fail"===a?(clearTimeout(e),e=null,r("success"===a)):t>0?(t--,next()):r(!1)},70)}()})}}]),WithLogin}()}}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function withPager(e){var t,n;return t=function(t){function WithPagerComponent(e){!function withPager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WithPagerComponent);var t=function withPager_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(WithPagerComponent.__proto__||Object.getPrototypeOf(WithPagerComponent)).call(this,e));n.call(t);var r=e||{},a=r.pageSize,o=void 0===a?10:a,i=r.pageNo,c=void 0===i?0:i,s=r.pageTotal,l={"hasNext":!0,"isLoading":!1,"total":void 0===s?0:s,"page_no":c,"page_size":o};return t.state.page=l,t}return function withPager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(WithPagerComponent,e),s(WithPagerComponent,[{"key":"resetPage","value":function resetPage(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=c({},this.state.page||{},{"page_no":0,"total":0,"isLoading":!1,"hasNext":!0});this.setState({"page":t},e)}}]),WithPagerComponent}(),n=function _initialiseProps(){var e=this;this.nextPage=function withPager_asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,a){try{var o=t[r](a),i=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(){var t,n,r,a,o,i;return regeneratorRuntime.wrap(function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if((t=e.state.page).hasNext&&!t.isLoading){s.next=3;break}return s.abrupt("return");case 3:return t.isLoading=!0,e.setState({"page":t}),n=t.page_no,r=t.page_size,a=n+1,s.next=9,e.fetch({"page_no":a,"page_size":r});case 9:o=s.sent,(!(i=o.total)||a>=Math.ceil(+i/r))&&(t.hasNext=!1),e.setState({"page":c({},t,{"total":i,"page_no":a,"isLoading":!1})});case 13:case"end":return s.stop()}},_callee,e)}))},t}var l=n(14),u=n(46),p=n.n(u),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function withBackToTop(e){return function(t){function WithBackToTopComponent(e){!function withBackToTop_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WithBackToTopComponent);var t=function withBackToTop_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(WithBackToTopComponent.__proto__||Object.getPrototypeOf(WithBackToTopComponent)).call(this,e));return t.scrollBackToTop=function(){t.setState({"scrollTop":1},function(){})},t.handleScroll=p()(function(e){var n=e.detail,r=n.scrollTop;n.scrollHeight<600||(r>300&&!t.state.showBackToTop?(l.m.debug("[BackToTop] showBackToTop, scrollTop: "+r),t.setState({"showBackToTop":!0})):t.state.showBackToTop&&r<=300&&(l.m.debug("[BackToTop] hideBackToTop, scrollTop: "+r),t.setState({"showBackToTop":!1})))},70),t.state=f({},t.state,{"scrollTop":null,"showBackToTop":!1}),t}return function withBackToTop_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(WithBackToTopComponent,e),WithBackToTopComponent}()}n.d(t,"b",function(){return withLogin}),n.d(t,"c",function(){return withPager}),n.d(t,"a",function(){return withBackToTop})},"419":function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r,a,o=n(3),i=n(4),c=n.n(i),s=n(735),l=n(475),u=n(416),p=n(352),f=(n(420),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var m=(a=r=function(e){function OrderItem(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OrderItem),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(OrderItem.__proto__||Object.getPrototypeOf(OrderItem)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(OrderItem,o["a"].Component),f(OrderItem,[{"key":"render","value":function render(){var e=this.props,t=e.info,n=e.onClick,r=e.payType,a=e.showExtra,o=e.customFooter;if(!t)return null;var i=t.pic_path?t.pic_path:Array.isArray(t.pics)?t.pics[0]:t.pics;return c.a.createElement(s.a,{"className":"order-item","onClick":n},c.a.createElement(s.a,{"className":"order-item__hd"},c.a.createElement(l.a,{"mode":"aspectFill","className":"order-item__img","src":i})),c.a.createElement(s.a,{"className":"order-item__bd"},c.a.createElement(u.a,{"className":"order-item__title"},t.title),this.props.renderDesc,a&&c.a.createElement(s.a,{"className":"order-item__extra"},c.a.createElement(u.a,{"className":"order-item__desc"},t.goods_props),t.num&&c.a.createElement(u.a,{"className":"order-item__num"},"数量：",t.num))),o?this.props.renderFooter:c.a.createElement(s.a,{"className":"order-item__ft"},"point"===r?c.a.createElement(p.l,{"className":"order-item__price","appendText":"积分","noSymbol":!0,"noDecimal":!0,"value":t.point}):c.a.createElement(p.l,{"className":"order-item__price","value":t.price}),c.a.createElement(u.a,{"className":"order-item__pay-type"},"dhpoint"===r?"积分支付":"微信支付")))}}]),OrderItem}(),r.defaultProps={"onClick":function onClick(){},"payType":"","showExtra":!0,"info":null},r.options={"addGlobalClass":!0},a)},"420":function(e,t,n){},"472":function(e,t,n){"use strict";n.d(t,"a",function(){return _});var r,a,o=n(3),i=n(4),c=n.n(i),s=n(735),l=n(416),u=n(405),p=n(352),f=n(14),m=n(419),d=(n(473),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var _=(a=r=function(e){function TradeItem(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TradeItem),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(TradeItem.__proto__||Object.getPrototypeOf(TradeItem)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TradeItem,o["a"].Component),d(TradeItem,[{"key":"handleClickBtn","value":function handleClickBtn(e){var t=this.props.info;this.props.onClickBtn&&this.props.onClickBtn(e,t)}},{"key":"render","value":function render(){var e=this.props,t=e.customHeader,n=e.customFooter,r=e.noHeader,a=e.onClick,o=e.info,i=e.payType,d=e.showActions;return o?c.a.createElement(s.a,{"className":"trade-item"},!r&&(t?c.a.createElement(s.a,{"className":"trade-item__hd"},this.props.renderHeader):c.a.createElement(s.a,{"className":"trade-item__hd"},c.a.createElement(l.a,{"className":"time"},o.create_date),c.a.createElement(l.a,{"className":"trade-item__shop"},"订单号：",o.tid))),c.a.createElement(s.a,{"className":"trade-item__bd","onClick":a},o.order.map(function(e,t){return c.a.createElement(m.a,{"key":t,"info":e,"payType":i})}),this.props.customRender?this.props.customRender:"point"===i?c.a.createElement(s.a,{"className":"trade-item__total"},"共",o.totalItems,"件商品 合计: ",c.a.createElement(p.l,{"appendText":"积分","noSymbol":!0,"noDecimal":!0,"value":o.point})):"dhpoint"===i?c.a.createElement(s.a,{"className":"trade-item__total"},"共",o.totalItems,"件商品 合计: ",c.a.createElement(p.l,{"appendText":"积分","noSymbol":!0,"noDecimal":!0,"value":o.total_fee})):c.a.createElement(s.a,{"className":"trade-item__total"},"共",o.totalItems,"件商品 合计: ",c.a.createElement(p.l,{"value":o.payment}))),n&&c.a.createElement(s.a,{"className":"trade-item__ft"},this.props.renderFooter),!n&&"WAIT_BUYER_PAY"===o.status&&c.a.createElement(s.a,{"className":"trade-item__ft"},c.a.createElement(s.a,{"className":"trade-item__ft-actions"}),c.a.createElement(s.a,{"className":"trade-item__ft-bd"},c.a.createElement(l.a,{"className":"trade-item__status"},o.status_desc),"PAYED"===o.order_status_des||"NOTPAY"===o.order_status_des?c.a.createElement(u.a,{"circle":!0,"type":"secondary","size":"small","onClick":this.handleClickBtn.bind(this,"cancel")},"取消订单"):null,c.a.createElement(u.a,{"circle":!0,"type":"primary","size":"small","onClick":this.handleClickBtn.bind(this,"pay")},"立即支付"))),!n&&"WAIT_SELLER_SEND_GOODS"===o.status&&c.a.createElement(s.a,{"className":"trade-item__ft"},c.a.createElement(s.a,{"className":"trade-item__ft-actions"}),c.a.createElement(s.a,{"className":"trade-item__ft-bd"},c.a.createElement(l.a,{"className":"trade-item__status"},o.status_desc),"PAYED"===o.order_status_des||"NOTPAY"===o.order_status_des?c.a.createElement(u.a,{"circle":!0,"type":"secondary","size":"small","onClick":this.handleClickBtn.bind(this,"cancel")},"取消订单"):null,c.a.createElement(u.a,{"circle":!0,"type":"primary","size":"small","onClick":this.handleClickBtn.bind(this,"detail")},"订单详情"))),!n&&"TRADE_CLOSED"===o.status&&c.a.createElement(s.a,{"className":"trade-item__ft"},c.a.createElement(s.a,{"className":"trade-item__ft-actions"}),c.a.createElement(s.a,{"className":"trade-item__ft-bd"},c.a.createElement(l.a,{"className":"trade-item__status"},o.status_desc),c.a.createElement(u.a,{"circle":!0,"type":"primary","size":"small","onClick":this.handleClickBtn.bind(this,"detail")},"订单详情"))),!n&&"WAIT_BUYER_CONFIRM_GOODS"===o.status&&c.a.createElement(s.a,{"className":"trade-item__ft"},c.a.createElement(s.a,{"className":"trade-item__ft-actions"},c.a.createElement(l.a,{"className":"trade-item__acts","onClick":this.props.onActionBtnClick.bind(this)},"更多"),c.a.createElement(s.a,{"className":Object(f.c)("trade-item__dropdown",{"is-active":d})},c.a.createElement(l.a,{"className":"trade-item__dropdown-item","onClick":this.props.onActionClick.bind(this,"confirm-receive")},"确认收货"),c.a.createElement(l.a,{"className":"trade-item__dropdown-item","onClick":this.props.onActionClick.bind(this,"view-express")},"查看物流"))),c.a.createElement(s.a,{"className":"trade-item__ft-bd"},c.a.createElement(l.a,{"className":"trade-item__status"},o.status_desc),c.a.createElement(u.a,{"circle":!0,"type":"secondary","size":"small","onClick":this.handleClickBtn.bind(this,"confirm")},"确认收货"),c.a.createElement(u.a,{"circle":!0,"type":"primary","size":"small","onClick":this.handleClickBtn.bind(this,"detail")},"订单详情"))),!n&&"WAIT_RATE"===o.status&&c.a.createElement(s.a,{"className":"trade-item__ft"},c.a.createElement(s.a,{"className":"trade-item__ft-actions"},c.a.createElement(l.a,{"className":"trade-item__acts"},"更多"),c.a.createElement(s.a,{"className":Object(f.c)("trade-item__dropdown",{"is-active":d})},c.a.createElement(l.a,{"className":"trade-item__dropdown-item","onClick":this.props.onActionClick.bind(this,"rate")},"评价|晒单"),c.a.createElement(l.a,{"className":"trade-item__dropdown-item","onClick":this.props.onActionClick.bind(this,"rebuy")},"再次购买"))),c.a.createElement(s.a,{"className":"trade-item__ft-bd"},c.a.createElement(l.a,{"className":"trade-item__status"},o.status_desc),c.a.createElement(u.a,{"circle":!0,"type":"secondary","size":"small","onClick":this.handleClickBtn.bind(this,"rate")},"评价"),c.a.createElement(u.a,{"circle":!0,"type":"primary","size":"small","onClick":this.handleClickBtn.bind(this,"detail")},"订单详情")))):null}}]),TradeItem}(),r.options={"addGlobalClass":!0},r.defaultProps={"customHeader":!1,"customFooter":!1,"customRender":!1,"noHeader":!1,"showActions":!1,"payType":"","info":null,"onClickBtn":function onClickBtn(){},"onClick":function onClick(){}},a)},"473":function(e,t,n){},"493":function(e,t,n){},"815":function(e,t,n){"use strict";n.r(t);var r,a,o=n(346),i=n(3),c=n(16),s=function stopPullDownRefresh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(t,n){var r=e.success,a=e.fail,o=e.complete,i={};c.a.eventCenter.trigger("__taroStopPullDownRefresh",{"successHandler":function successHandler(){r&&r(i),o&&o(),t(i)},"errorHandler":function errorHandler(){a&&a(i),o&&o(),n(i)}})})},l=n(4),u=n.n(l),p=n(735),f=n(736),m=n(411),d=n(412),_=n(454),h=n.n(_),y=n(352),b=n(6),g=n(351),v=n(14),k=n(472),w=(n(493),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),T=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,a){try{var o=t[r](a),i=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}t.default=(r=Object(g.b)(),Object(g.c)(a=r(a=function(e){function TradeList(e){var t=this;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TradeList);var n,r=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(TradeList.__proto__||Object.getPrototypeOf(TradeList)).call(this,e));return r.onPullDownRefresh=function(){Object(o.b)({"title":"加载中","icon":"none"}),r.resetPage(function(){r.nextPage(),r.setState({"list":[]}),Object(o.a)()})},r.handleClickTab=function(e){r.hideLayer(),r.state.page.isLoading||(e!==r.state.curTabIdx&&(r.resetPage(),r.setState({"list":[]})),r.setState({"curTabIdx":e},function(){r.nextPage()}))},r.handleClickItem=function(e){var t=e.tid;i.a.navigateTo({"url":"/pages/trade/detail?id="+t})},r.handleClickItemBtn=(n=_asyncToGenerator(regeneratorRuntime.mark(function _callee(e,n){var a,o,c;return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.tid,"confirm"!==n){t.next=7;break}return t.next=4,b.a.trade.confirm(a);case 4:return o=Object(v.g)(r.$router),c=o.fullPath,i.a.redirectTo({"url":c}),t.abrupt("return");case 7:t.t0=n,t.next="cancel"===t.t0?10:12;break;case 10:return i.a.navigateTo({"url":"/pages/trade/cancel?order_id="+a}),t.abrupt("break",13);case 12:i.a.navigateTo({"url":"/pages/trade/detail?id="+a});case 13:case"end":return t.stop()}},_callee,t)})),function(e,t){return n.apply(this,arguments)}),r.handleActionClick=function(e,t){console.log(e,t),r.hideLayer()},r.handleActionBtnClick=function(e){console.log(e),r.setState({"curItemActionsId":e.tid})},r.hideLayer=function(){r.setState({"curItemActionsId":null})},r.state=w({},r.state,{"curTabIdx":0,"tabList":[{"title":"全部订单","status":"0"},{"title":"待付款","status":"5"},{"title":"待收货","status":"1"},{"title":"已完成","status":"3"}],"list":[],"curItemActionsId":null}),r}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TradeList,i["a"].Component),T(TradeList,[{"key":"componentDidShow","value":function componentDidShow(){var e=this,t=this.$router.params.status,n=this.state.tabList.findIndex(function(e){return e.status===t});n>=0?this.setState({"curTabIdx":n,"list":[]},function(){e.resetPage(),setTimeout(function(){e.nextPage()},500)}):(this.resetPage(),this.setState({"list":[]}),setTimeout(function(){e.nextPage()},500))}},{"key":"componentWillUnmount","value":function componentWillUnmount(){this.hideLayer()}},{"key":"fetch","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(e){var t,n,r,a,o,i,c;return regeneratorRuntime.wrap(function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return t=this.state,n=t.tabList,r=t.curTabIdx,e=h()(w({},e,{"order_type":"normal","status":n[r].status}),function(e,t){return"page_no"===t?"page":"page_size"===t?"pageSize":t}),l.next=4,b.a.trade.list(e);case 4:return a=l.sent,o=a.list,i=a.pager.count,c=Object(v.q)(o,{"tid":"order_id","status_desc":"order_status_msg","order_status_des":"order_status_des","status":function status(e){var t=e.order_status;return Object(v.r)(t)},"totalItems":function totalItems(e){return e.items.reduce(function(e,t){return+t.num+e},0)},"payment":function payment(e){return(e.total_fee/100).toFixed(2)},"total_fee":"total_fee","pay_type":"pay_type","point":"point","create_date":"create_date","order":function order(e){var t=e.items;return Object(v.q)(t,{"order_id":"order_id","item_id":"item_id","pic_path":"pic","title":"item_name","price":function price(e){return(+e.item_fee/100).toFixed(2)},"item_fee":"item_fee","point":"item_point","num":"num"})}}),v.m.debug("[trade list] list fetched and processed: ",c),this.setState({"list":[].concat(_toConsumableArray(this.state.list),_toConsumableArray(c))}),s(),l.abrupt("return",{"total":i});case 12:case"end":return l.stop()}},_callee2,this)}));return function fetch(t){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){var e=this,t=this.state,n=t.curTabIdx,r=t.curItemActionsId,a=t.tabList,o=t.list,i=t.page;return u.a.createElement(p.a,{"className":"page-trade-list"},u.a.createElement(y.k,{"title":"订单列表","leftIconType":"chevron-left","fixed":"true"}),u.a.createElement(m.a,{"className":"trade-list__tabs","current":n,"tabList":a,"onClick":this.handleClickTab},a.map(function(e,t){return u.a.createElement(d.a,{"current":n,"key":t,"index":t})})),u.a.createElement(f.a,{"scrollY":!0,"className":"trade-list__scroll","onScrollToUpper":this.onPullDownRefresh.bind(this),"onScrollToLower":this.nextPage},o.map(function(t){return u.a.createElement(k.a,{"payType":t.pay_type,"key":t.tid,"info":t,"showActions":r===t.tid,"onClick":e.handleClickItem.bind(e,t),"onClickBtn":e.handleClickItemBtn.bind(e,t),"onActionBtnClick":e.handleActionBtnClick.bind(e,t),"onActionClick":e.handleActionClick.bind(e,t)})}),i.isLoading&&u.a.createElement(y.j,null,"正在加载..."),!i.isLoading&&!i.hasNext&&!o.length&&u.a.createElement(y.r,{"img":"trades_empty.png"},"赶快去添加吧~"),!!r&&u.a.createElement(p.a,{"className":"layer","onClick":this.hideLayer})))}},{"key":"componentDidMount","value":function componentDidMount(){}}]),TradeList}())||a)||a)}}]);